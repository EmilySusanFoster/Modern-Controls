<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>

<head>
<title>A. Notation, symbols and acronyms</title>
<meta name="description" content="A. Notation, symbols and acronyms">
<meta name="keywords" content="appendixa">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="STYLESHEET" href="appendixa.css">
</head>

<body topmargin="3" leftmargin="3" bgcolor="#FFFFFF" text="#000000" link="#993300" vlink="#660000" alink="#FF0000">

<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" width="600">
    <tr>
      <td>

        <p align="left">You are here : <a href="../index.html" target="_top">Control
        System Design - Index</a> | <a href="../book.html">Book Contents</a> | <a href="appendixd-node1.html">Appendix
        D</a> | Section D.5</p>
        <h2 align="center">D. Properties of Continuous Time Riccati Equation</h2>
        <h3>D.5 Duality between linear quadratic regulator and optimal linear
        filter</h3>

        <p>The close connections between the optimal filter and the LQR problem
        can be expressed directly as follows: we consider the problem of
        estimating a particular linear combination of the states, namely</p>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr valign="MIDDLE">
            <td align="CENTER" nowrap><img border="0" src="appendixd-img65.gif" width="101" height="21"></td>
            <td width="10" align="RIGHT">(D.5.1)</td>
          </tr>
        </table>

        <p>(The final solution will turn out to be independent of <i>f</i> and
        thus will hold for the complete state vector.)</p>

        <p>Now we will estimate <i>z</i>(<i>t</i>) using a linear filter of the
        form</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img66.gif" width="250" height="45"></td>
              <td width="10" align="RIGHT">(D.5.2)</td>
            </tr>
          </table>
        </div>

        <p>where <i>h</i>(<i>t</i>) is the impulse response of the filter, and
        where <img border="0" src="appendixd-img71.gif" align="middle" width="19" height="16">
        is a given estimate of the initial state. Indeed, we will assume that
        (22.10.17) holds, i.e. the initial state <i>x</i>(0) satisfies</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img67.gif" width="222" height="21"></td>
              <td width="10" align="RIGHT">(D.5.3)</td>
            </tr>
          </table>
        </div>

        <p>We will be interested in designing the filter impulse response,
        <tex2html_image_mark><img border="0" src="appendixd-img68.gif" align="middle" width="32" height="18">
        so that <img border="0" src="appendixd-img69.gif" align="middle" width="32" height="18">
        is <em>close </em>to <i>z</i>(<i>t</i>) in some sense. (Indeed, the
        precise sense we will use is a quadratic form.) From (D.5.1) and (D.5.2)
        we see that</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img70.gif" width="379" height="114"></td>
              <td width="10" align="RIGHT">(D.5.4)</td>
            </tr>
          </table>
        </div>

        <p>Equation (D.5.4) is somewhat difficult to deal with, because of the
        cross product between <img border="0" src="appendixd-img72.gif" align="middle" width="59" height="20">
        and <i>x</i>(<i>t</i>) in the integral. Hence, we introduce another
        variable <img border="0" src="appendixd-img40.gif" align="middle" width="11" height="15">
        using the following equation</p>
        <div align="center">
          <table border="0" cellpadding="2" cellspacing="0" width="600">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img73.gif" width="205" height="37"></td>
              <td width="10" align="RIGHT">(D.5.5)</td>
            </tr>
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img74.gif" width="72" height="18"></td>
              <td width="10" align="RIGHT">(D.5.6)</td>
            </tr>
          </table>
        </div>

        <p>where <img border="0" src="appendixd-img75.gif" align="middle" width="32" height="18">
        is the reverse time form of <i>h</i>, i.e.</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td>

                <p align="center"><img border="0" src="appendixd-img76.gif" width="110" height="18"></td>
              <td width="10" align="right">(D.5.7)</td>
            </tr>
          </table>
        </div>

        <p>Substituting (D.5.5) into (D.5.4) gives</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img77.gif" width="342" height="94"></td>
              <td width="10" align="RIGHT">(D.5.8)</td>
            </tr>
          </table>
        </div>

        <p>Using integration by parts, we then obtain</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img78.gif" width="436" height="75"></td>
              <td width="10" align="RIGHT">(D.5.9)</td>
            </tr>
          </table>
        </div>

        <p>Finally, using (22.10.5) and (D.5.6), we obtain</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img79.gif" width="459" height="70"></td>
              <td width="10" align="RIGHT">(D.5.10)</td>
            </tr>
          </table>
        </div>

        <p>Hence, squaring and taking mathematical expectations, we obtain (on
        using (D.5.3), (22.10.3) and (22.10.4) ):</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img80.gif" width="436" height="66"></td>
              <td width="10" align="RIGHT">(D.5.11)</td>
            </tr>
          </table>
        </div>

        <p>The last term in (D.5.10) is zero if <img border="0" src="appendixd-img81.gif" align="middle" width="73" height="18">.
        Then, we see that the design of the optimal linear filter can be
        achieved by minimizing</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img82.gif" width="392" height="51"></td>
              <td width="10" align="RIGHT">(D.5.12)</td>
            </tr>
          </table>
        </div>

        <p>where <img border="0" src="appendixd-img83.gif" align="middle" width="31" height="18">
        satisfies the reverse time equations (D.5.5) and (D.5.6). We recognize
        the set of equations formed by (D.5.5), (D.5.6) and (D.5.12) as a <b>standard
        linear regulator problem</b>, provided the connections shown in Table
        D.1 are made.</p>

        <p align="center"><strong>Table 1.1:</strong> Duality in quadratic
        regulators and filters</p>
        <div align="CENTER">
          <table>
            <tr>
              <td>
                <div align="CENTER">
                  <table cellpadding="4" border="1" cellspacing="0">
                    <tr>
                      <td align="CENTER">Regulator</td>
                      <td align="CENTER">Filter</td>
                      <td align="center" width="4">&nbsp;</td>
                      <td align="CENTER">Regulator</td>
                      <td align="CENTER">Filter</td>
                    </tr>
                    <tr>
                      <td align="CENTER"><img border="0" src="appendixd-img84.gif" width="21" height="101"></td>
                      <td align="CENTER"><img border="0" src="appendixd-img85.gif" width="39" height="102"></td>
                      <td align="center" width="4">&nbsp;</td>
                      <td align="CENTER"><img border="0" src="appendixd-img86.gif" width="30" height="102"></td>
                      <td align="CENTER"><img border="0" src="appendixd-img87.gif" width="24" height="102"></td>
                    </tr>
                  </table>
                </div>
            </tr>
          </table>
        </div>

        <p>Finally, using the (dual) optimal control results presented earlier,
        we see that the optimal filter is given by</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img88.gif" width="237" height="43"></td>
              <td width="10" align="RIGHT">(D.5.13)</td>
            </tr>
          </table>
        </div>

        <p>where</p>
        <div align="center">
          <table border="0" cellpadding="2" cellspacing="0" width="100%">
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img89.gif" width="146" height="18"></td>
              <td width="10" align="RIGHT">(D.5.14)</td>
            </tr>
            <tr>
              <td align="CENTER" nowrap><img border="0" src="appendixd-img90.gif" width="142" height="21"></td>
              <td width="10" align="RIGHT">(D.5.15)</td>
            </tr>
          </table>
        </div>

        <p>and <img border="0" src="appendixd-img91.gif" align="middle" width="34" height="16">
        satisfies the dual form of (D.0.1), (22.4.18), i.e.</p>

        <p align="right"><img border="0" src="appendixd-img93.gif" width="506" height="85"></p>

        <p>Substituting (D.5.14) into (D.5.5), (D.5.6) we see that</p>

        <p align="right"><img border="0" src="appendixd-img94.gif" width="409" height="107"></p>

        <p>We see that <img border="0" src="appendixd-img95.gif" align="middle" width="38" height="18">
        is the output of a linear homogeneous equation. Let <img border="0" src="appendixd-img96.gif" align="middle" width="71" height="18">
        and define <img border="0" src="appendixd-img97.gif" align="middle" width="34" height="18">
        as the state transition matrix from <img border="0" src="appendixd-img98.gif" align="middle" width="47" height="14">
        for the time varying system having <i>A</i> - <i>matrix</i> equal to <img border="0" src="appendixd-img99.gif" align="middle" width="135" height="22">.
        Then</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td>

                <p align="center"><img border="0" src="appendixd-img100.gif" width="181" height="73"></td>
              <td width="10" valign="top">(D.5.22)</td>
            </tr>
          </table>
        </div>

        <p>Hence the optimal filter satisfies</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td>

                <p align="center"><img border="0" src="appendixd-img101.gif" width="345" height="214"></td>
              <td width="10" valign="top">(D.5.23)</td>
            </tr>
          </table>
        </div>

        <p>where</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td>

                <p align="center"><img border="0" src="appendixd-img102.gif" width="312" height="60"></td>
              <td width="10" align="right">(D.5.24)</td>
            </tr>
          </table>
        </div>

        <p>We then observe that (D.5.24) is actually the solution of the
        following state space (optimal filter).</p>

        <p align="right"><img border="0" src="appendixd-img103.gif" width="443" height="87"></p>

        <p>We see that the final solution depends on&nbsp; <i>f</i> only through
        (D.5.27). Thus, as predicted, (D.5.25), (D.5.26) can be used to generate
        an optimal estimate of any linear combination of states.</p>

        <p>Of course, the optimal filter (D.5.25) is identical to that given in
        (22.10.23).</p>

        <p>All of the properties of the optimal filter follow by analogy from
        the (dual) optimal linear regulator. In particular, we observe that
        (D.5.16) and (D.5.17) are a CTDRE and its boundary condition,
        respectively. The only difference is that, in the optimal filter case,
        this equation has to be solved forward in time. Also, (D.5.16) has an
        associated CTARE, given by</p>
        <div align="center">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
              <td>

                <p align="center"><img border="0" src="appendixd-img104.gif" width="329" height="22"></td>
              <td width="10" align="right">(D.5.28)</td>
            </tr>
          </table>
        </div>

        <p>Thus, the existence, uniqueness and properties of stabilizing
        solutions for (D.5.16) and (D.5.28), satisfy the same conditions as the
        corresponding Riccati equations for the optimal regulator.</p>
        <div align="center">
          <table border="0" cellpadding="0" width="500" cellspacing="0">
            <tr>
              <td align="center" width="33%"><a href="appendixd-node9.html"><img src="../images/backbutton.gif" border="0" alt="&lt;-" width="32" height="32"><br>
                Previous - Section D.4</a></td>
              <td align="center" width="33%"><a href="appendixd-node1.html"><img src="../images/upbutton.gif" border="0" alt="^" width="32" height="32"><br>
                Up - Appendix D</a></td>
              <td align="center" width="33%"><img border="0" src="../images/nextbutton.gif" width="32" height="32"><br>
                Next</td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
  </div>

  <p>&nbsp;</p>
</center>

</body>

</html>
